query: "with r as (select /* pgwatch_generated */\n    nspname::text as object_name\n\
  \    from pg_namespace\n    where nspname = 'public' and nspacl::text ~ E'[,\\\\\
  {]+=U?C/'),\nlimited_r as (select * from r limit 25),\nrr as (select\n    (extract(epoch\
  \ from now()) * 1e9)::int8 as epoch_ns,\n    'default_public_schema_privs'::text\
  \ as tag_reco_topic,\n    string_agg(object_name, ',') as tag_object_name,\n   \
  \ 'REVOKE CREATE ON SCHEMA public FROM PUBLIC;'::text as recommendation,\n    'only\
  \ authorized users should be allowed to create new objects'::text as extra_info\n\
  \    from limited_r),\nlast_reco(s) as (\n    select case when count(*) > 25 then\
  \ format(' and found %s more...', count(*)-25) end from r),\ntotal_count as (\n\
  \    select count(*) as total from r)\nselect \n    epoch_ns,\n    tag_reco_topic,\n\
  \    concat(tag_object_name, s) as tag_object_name,\n    recommendation,\n    extra_info,\n\
  \    total as total_recommendations\nfrom rr, last_reco, total_count\nwhere tag_object_name\
  \ > '';\n"
metrics: []
