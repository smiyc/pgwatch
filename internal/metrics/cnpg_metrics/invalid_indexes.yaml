query: "select /* pgwatch_generated */\n  (extract(epoch from now()) * 1e9)::int8\
  \ as epoch_ns,\n  format('%I.%I', n.nspname , ci.relname) as tag_index_full_name,\n\
  \  coalesce(pg_relation_size(indexrelid), 0) as index_size_b\nfrom\n  pg_index i\n\
  \  join pg_class ci on ci.oid = i.indexrelid\n  join pg_class cr on cr.oid = i.indrelid\n\
  \  join pg_namespace n on n.oid = ci.relnamespace\nwhere not n.nspname like E'pg\\\
  \\_temp%'\nand not indisvalid\nand not exists ( /* leave out ones that are being\
  \ actively rebuilt */\n  select * from pg_locks l\n  join pg_stat_activity a using\
  \ (pid)\n  where l.relation = i.indexrelid\n  and a.state = 'active'\n  and a.query\
  \ ~* 'concurrently'\n)\nand not exists (select * from pg_locks where relation =\
  \ indexrelid and mode = 'AccessExclusiveLock') /* can't get size then */\norder\
  \ by index_size_b desc\nlimit 100"
metrics: []
