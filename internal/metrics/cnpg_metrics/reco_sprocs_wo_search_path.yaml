query: "with r as (select /* pgwatch_generated */\n    p.oid::regproc::text as object_name\n\
  \    from pg_proc p\n    where prosecdef and not 'search_path' = ANY(coalesce(proconfig,\
  \ '{}'::text[]))\n    and not pg_catalog.obj_description(p.oid, 'pg_proc') ~ 'pgwatch'),\n\
  limited_r as (select * from r limit 25),\nrr as (select\n    (extract(epoch from\
  \ now()) * 1e9)::int8 as epoch_ns,\n    'sprocs_wo_search_path'::text as tag_reco_topic,\n\
  \    string_agg(object_name, ',') as tag_object_name,\n    'functions without fixed\
  \ search_path can be potentially abused by malicious users if used objects are not\
  \ fully qualified'::text as recommendation,\n    'ALTER FUNCTION <function_name>\
  \ SET search_path = pg_catalog, pg_temp;'::text as extra_info\n    from limited_r),\n\
  last_reco(s) as (\n    select case when count(*) > 25 then format(' and found %s\
  \ more...', count(*)-25) end from r),\ntotal_count as (\n    select count(*) as\
  \ total from r)\nselect \n    epoch_ns,\n    tag_reco_topic,\n    concat(tag_object_name,\
  \ s) as tag_object_name,\n    recommendation,\n    extra_info,\n    total as total_recommendations\n\
  from rr, last_reco, total_count\nwhere tag_object_name > '';"
metrics: []
